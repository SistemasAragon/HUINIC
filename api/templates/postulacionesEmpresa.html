{% include  'includeEmpresa.html' %}
{% load static%}
<!DOCTYPE html>
<html lang="en">


<head>
    <title>HUINIC | Postulaciones empresa</title>

    
    <!-- Luego incluye DataTables -->
    <script src="https://cdn.datatables.net/1.10.24/js/jquery.dataTables.min.js"></script>
    <link rel="stylesheet" href="https://cdn.datatables.net/1.10.24/css/jquery.dataTables.min.css">

    <!-- Ventanas -->
    <link href="{% static 'css/sweetalert2.css'%}" rel="stylesheet" type="text/css">
    <link href="{% static 'css/sweetalert2Tres.css'%}" rel="stylesheet" type="text/css">

    
</head>

<body>


    <!-- Start Home -->
    <section class="bg-default page-next-level" style="background: url({% static 'images/bg/bg-page.png'%}) center no-repeat;">
        <div class="home-center">
            <div class="home-desc-center">
                <div class="container">
                    <div class="row align-items-center">
                        <div class="col-12 mt-4">
                            <div class="text-center">
                                <h3 class="title-pager mb-0">Postulaciones @CUDE </h3>
                            </div>
                        </div>
                        <!--end col-->
                    </div>
                    <!--end row-->
                </div>
                <!--end container-->
            </div>
        </div>
    </section>
    <!--end section-->
    <!-- End Home -->


    <!-- START -->
    <section class="section">
        <div class="container">
            <div class="row">
                <table id="TablaPostulaciones" class="hover table table-sm table-centered table-hover table-borderless mb-0">
                    <thead class="border-top border-bottom bg-light-subtle border-light">
                        <tr>
                            <th scope="col">Puesto</th>
                            <th scope="col">Edad</th>
                            <th scope="col">Estado Civil</th>
                            <th scope="col">Área</th>
                            <th scope="col">Área específica</th>
                            <th scope="col">Salario</th>
                            <th scope="col">Acciones</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Gerente de taller</td>
                            <td>18 - 20</td>
                            <td>Soltero</td>
                            <td>Automotriz</td>
                            <td>Motor</td>
                            <td>8000</td>
                            <td>
                                <a href="#" class="btn btn-primary mt-2" onclick="editarPostulacion()">
                                    Editar 
                                </a>
                                <a href="{% url 'listaCandidatosVacante' %}" class="btn btn-primary mt-2">
                                    Lista 
                                </a>
                                <a href="{% url 'resultadosVacantes' %}" class="btn btn-primary mt-2">
                                    Mejores 
                                </a>
                            </td>
                        </tr>
                        <tr>
                            <td>Administrador de inventario</td>
                            <td>18 - 25</td>
                            <td>Soltero</td>
                            <td>Automotriz</td>
                            <td>Pintura</td>
                            <td>9000</td>
                            <td>
                                <a href="#" class="btn btn-primary mt-2" onclick="editarPostulacion()">
                                    Editar 
                                </a>
                                <a href="{% url 'listaCandidatosVacante' %}" class="btn btn-primary mt-2">
                                    Lista 
                                </a>
                                <a href="{% url 'resultadosVacantes' %}" class="btn btn-primary mt-2">
                                    Mejores 
                                </a>
                            </td>
                        </tr>
                        <tr>
                            <td>Mecánico motocicleta</td>
                            <td>30 - 40</td>
                            <td>Casado</td>
                            <td>Motocicleta</td>
                            <td>Eléctrico</td>
                            <td>10000</td>
                            <td>
                                <a href="#" class="btn btn-primary mt-2" onclick="editarPostulacion()">
                                    Editar 
                                </a>
                                <a href="{% url 'listaCandidatosVacante' %}" class="btn btn-primary mt-2">
                                    Lista 
                                </a>
                                <a href="{% url 'resultadosVacantes' %}" class="btn btn-primary mt-2">
                                    Mejores 
                                </a>
                            </td>
                        </tr>
                        <tr>
                            <td>Gerente de taller</td>
                            <td>25 - 40</td>
                            <td>Casado</td>
                            <td>Automotriz</td>
                            <td>Eléctrico</td>
                            <td>15000</td>
                            <td>
                                <a href="#" class="btn btn-primary mt-2" onclick="editarPostulacion()">
                                    Editar 
                                </a>
                                <a href="{% url 'listaCandidatosVacante' %}" class="btn btn-primary mt-2">
                                    Lista 
                                </a>
                                <a href="{% url 'resultadosVacantes' %}" class="btn btn-primary mt-2">
                                    Mejores 
                                </a>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
        <!-- end container -->
    </section>
    
    <!-- END -->

    <!-- Footer End -->
    {% include  'includeFooter.html' %}
    <!-- Footer End -->

    <!-- SweetAlert2 -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@10"></script>

    

    <script>
        $(document).ready(function () {
        $('#TablaPostulaciones').DataTable({
            lengthMenu: [5, 10, 15],
            pageLength: 5,
            destroy:true,
            "language": {
                lengthMenu: "Mostrar _MENU_ registros por página",
                zeroRecords: "Ningúna postulación encontrada",
                info: "Mostrando _END_ de _MAX_ postulaciones",
                infoEmpty: "Ningúna postulación encontrada",
                infoFiltered: "",
                search: "Buscar:",
                loadingRecords: "Cargando... ",
                paginate: {
                    first: "Primero",
                    last: "Último",
                    next: "Siguiente",
                    previous: "Anterior"
                }
            }
            // Otras opciones y configuraciones de DataTables que puedas tener...
        });
        });
    </script>

    <!-- Script de editar datos-->
    <script>
        function editarPostulacion() {
            Swal.fire({
                title: 'Información de postulación',
                html:
                `<div class="my-swal-label-container">` +
                        '<div class="row">' +
                            '<div class="col-6">' +
                                `<li class="my-swal-list-item"><span class="my-swal-label">Puesto</span>` +
                                    `<div class="my-swal-input-container">` +
                                        `<input id="clave" name="clave" class="swal2-input my-swal-input" maxlength="25" value="Prueba" >` +
                                    `</div>` +
                                `</li>` +
                            '</div>' +
                            '<div class="col-2">' +
                                `<li class="my-swal-list-item"><span class="my-swal-label">Edad inicial</span>` +
                                    `<div class="my-swal-input-container">` +
                                        `<input id="clave" name="clave" class="swal2-input my-swal-input" maxlength="10" value="18" >` +
                                    `</div>` +
                                `</li>` +
                            '</div>' +
                            '<div class="col-2">' +
                                `<li class="my-swal-list-item"><span class="my-swal-label ">Edad final</span>` +
                                    `<div class="my-swal-input-container">` +
                                        `<input id="clave" name="clave" class="swal2-input my-swal-input" maxlength="10" value="25" >` +
                                    `</div>` + 
                                `</li>` +
                            '</div>' +  
                            '<div class="col-2">' +
                                `<li class="my-swal-list-item"><span class="my-swal-label">Salario</span>` +
                                    `<div class="my-swal-input-container">` +
                                        `<input id="clave" name="clave" class="swal2-input my-swal-input" maxlength="10" value="2000" >` +
                                    `</div>` +  
                                `</li>` +
                            '</div>' + 
                        '</div>' +
                        '<p></p>' +
                        '<div class="row">' +
                            '<div class="col-4">' +
                                `<li class="my-swal-list-item"><span class="my-swal-label">Estado Civil</span>` +
                                    `<div class="my-swal-text" style="font-size: 12px;" disabled>Soltero</div></li >` +
                                        `<div class="my-swal-input-container">` +
                                            '<select class="form-select" id="nuevoCargo" name="nuevoCargo" required>' +
                                                '<option value="" disabled selected>Selecciona un cargo</option>' +
                                                '<option value="Casado">Casado</option>' +
                                            '</select>' +
                                        `</div>` +
                                `</li>` +        
                            '</div>' +  
                            '<div class="col-4">' +
                                `<li class="my-swal-list-item"><span class="my-swal-label">Genero</span>` +
                                    `<div class="my-swal-text" style="font-size: 12px;" disabled>Masculino</div></li >` +
                                        `<div class="my-swal-input-container">` +
                                            '<select class="form-select" id="nuevoCargo" name="nuevoCargo" required>' +
                                                '<option value="" disabled selected>Selecciona un genero</option>' +
                                                '<option value="Femenino">Femenino</option>' +
                                            '</select>' +
                                        `</div>` +
                                `</li>` +        
                            '</div>' + 
                            '<div class="col-4">' +
                                `<li class="my-swal-list-item"><span class="my-swal-label">Vehiculo</span>` +
                                    `<div class="my-swal-text" style="font-size: 12px;" disabled>Auto</div></li >` +
                                        `<div class="my-swal-input-container">` +
                                            '<select class="form-select" id="nuevoCargo" name="nuevoCargo" required>' +
                                                '<option value="" disabled selected>Selecciona un vehiculo</option>' +
                                                '<option value="Femenino">Moto</option>' +
                                            '</select>' +
                                        `</div>` +
                                `</li>` +        
                            '</div>' +
                        '</div>' +
                        '<p></p>' +
                        '<div class="row">' + 
                            '<div class="col-4">' +
                                `<li class="my-swal-list-item"><span class="my-swal-label">Area</span>` +
                                    `<div class="my-swal-text" style="font-size: 12px;" disabled>Disel pesado</div></li >` +
                                        `<div class="my-swal-input-container">` +
                                            '<select class="form-select" id="nuevoCargo" name="nuevoCargo" required>' +
                                                '<option value="" disabled selected>Selecciona una area</option>' +
                                                '<option value="Femenino">Disel ligero</option>' +
                                            '</select>' +
                                        `</div>` +
                                `</li>` +        
                            '</div>' +
                            '<div class="col-4">' +
                                `<li class="my-swal-list-item"><span class="my-swal-label">Area especifica</span>` +
                                    `<div class="my-swal-text" style="font-size: 12px;" disabled>Sistemas de enfriamento</div></li >` +
                                        `<div class="my-swal-input-container">` +
                                            '<select class="form-select" id="nuevoCargo" name="nuevoCargo" required>' +
                                                '<option value="" disabled selected>Selecciona un area especifica</option>' +
                                                '<option value="Femenino">Sistemas de frenado</option>' +
                                            '</select>' +
                                        `</div>` +
                                `</li>` +        
                            '</div>' +
                            '<div class="col-4">' +
                                `<li class="my-swal-list-item"><span class="my-swal-label">Nivel</span>` +
                                    `<div class="my-swal-text" style="font-size: 12px;" disabled>Sistemas de enfriamento</div></li >` +
                                        `<div class="my-swal-input-container">` +
                                            '<select class="form-select" id="nuevoCargo" name="nuevoCargo" required>' +
                                                '<option value="" disabled selected>Selecciona un nivel</option>' +
                                                '<option value="Femenino">Desarrollador</option>' +
                                            '</select>' +
                                        `</div>` +
                                `</li>` +        
                            '</div>' +
                        '</div>' +
                        '<p></p>' +
                        '<label class="form-label fs-5 text-center"><span class="my-swal-label">Habilidades (5 Maximo)<span class="text-danger">*</span></span></label>' +
                        '<div class="col-md-12 mt-3">' +
                            '<div class="form-icon position-relative">' +
                                '<div class="row izquierda letraChida">' +
                                    '<div class="col-md-4">' +
                                        '<input type="checkbox" id="habilidad1" name="habilidad" value="Trabajo en equipo">' +
                                        '<label for="habilidad1"> Trabajo en equipo</label>' +
                                    '</div>' +
                                    '<div class="col-md-4">' +
                                        '<input type="checkbox" id="habilidad2" name="habilidad" value="Comunicación efectiva">' +
                                        '<label for="habilidad2">Comunicación efectiva</label>' +
                                    '</div>' +
                                    '<div class="col-md-4">' +
                                        '<input type="checkbox" id="habilidad3" name="habilidad" value="Resolución de problemas">' +
                                        '<label for="habilidad3">Resolución de problemas</label>' +
                                    '</div>' +
                                '</div>' +
                                '<div class="row mt-2 izquierda letraChida">' +
                                    '<div class="col-md-4">' +
                                        '<input type="checkbox" id="habilidad4" name="habilidad" value="Liderazgo">' +
                                        '<label for="habilidad4">Liderazgo</label>' +
                                    '</div>' +
                                    '<div class="col-md-4">' +
                                        '<input type="checkbox" id="habilidad5" name="habilidad" value="Adaptabilidad">' +
                                        '<label for="habilidad5">Adaptabilidad</label>' +
                                    '</div>' +
                                    '<div class="col-md-4">' +
                                        '<input type="checkbox" id="habilidad6" name="habilidad" value="Creatividad">' +
                                        '<label for="habilidad6">Creatividad</label>' +
                                    '</div>' +
                                '</div>' +
                                '<div class="row mt-2 izquierda letraChida">' +
                                    '<div class="col-md-4">' +
                                        '<input type="checkbox" id="habilidad7" name="habilidad" value="Pensamiento crítico">' +
                                        '<label for="habilidad7">Pensamiento crítico</label>' +
                                    '</div>' +
                                    '<div class="col-md-4">' +
                                        '<input type="checkbox" id="habilidad8" name="habilidad" value="Gestión del tiempo">' +
                                        '<label for="habilidad8">Gestión del tiempo</label>' +
                                    '</div>' +
                                    '<div class="col-md-4">' +
                                        '<input type="checkbox" id="habilidad9" name="habilidad" value="Empatía">' +
                                        '<label for="habilidad9">Empatía</label>' +
                                    '</div>' +
                                '</div>' +
                                '<div class="row mt-2 izquierda letraChida">' +
                                    '<div class="col-md-4">' +
                                        '<input type="checkbox" id="habilidad10" name="habilidad" value="Capacidad de aprendizaje">' +
                                        '<label for="habilidad10">Capacidad de aprendizaje</label>' +
                                    '</div>' +
                                    '<div class="col-md-4">' +
                                        '<input type="checkbox" id="habilidad11" name="habilidad" value="Negociación">' +
                                        '<label for="habilidad11">Negociación</label>' +
                                    '</div>' +
                                    '<div class="col-md-4">' +
                                        '<input type="checkbox" id="habilidad12" name="habilidad" value="Toma de decisiones">' +
                                        '<label for="habilidad12">Toma de decisiones</label>' +
                                    '</div>' +
                                '</div>' +
                                '<div class="row mt-2 izquierda letraChida">' +
                                    '<div class="col-md-4">' +
                                        '<input type="checkbox" id="habilidad13" name="habilidad" value="Pensamiento analítico">' +
                                        '<label for="habilidad13">Pensamiento analítico</label>' +
                                    '</div>' +
                                    '<div class="col-md-4">' +
                                        '<input type="checkbox" id="habilidad14" name="habilidad" value="Autoconfianza">' +
                                        '<label for="habilidad14">Autoconfianza</label>' +
                                    '</div>' +
                                    '<div class="col-md-4">' +
                                        '<input type="checkbox" id="habilidad15" name="habilidad" value="Resiliencia">' +
                                        '<label for="habilidad15">Resiliencia</label>' +
                                    '</div>' +
                                '</div>' +
                                '<div id="mensaje-habilidades" class="mt-2" style="display: none;">' +
                                '<p class="text-danger">Ya has seleccionado las 5 habilidades. No puedes seleccionar más.</p>' +
                                '</div>' +
                            '</div>' +
                        '</div>' +
                    `</div>`,
                focusConfirm: false,
                showCancelButton: true,
                confirmButtonText: 'Aceptar',
                cancelButtonText: 'Cerrar',
                allowOutsideClick: false,
                customClass: {
                    container: 'my-swal-container2',
                    popup: 'my-swal-popup2',
                    title: 'my-swal-title2',
                    input: 'my-swal-input2',
                    cancelButton: 'my-swal-cancel-button2',
                    confirmButton: 'my-swal-confirm-button2',
                }, 
                preConfirm: () => {
                    const claveEmpleado = Swal.getPopup().querySelector('#claveEmpleado').value;

                    return fetch('{% url 'postulacionesEmpresa' %}', {
                            method: 'PUT',
                            headers: {
                                'Content-Type': 'application/json',
                                'X-CSRFToken': getCookie('csrftoken')
                            },
                            body: JSON.stringify({
                                claveEmpleado: claveEmpleado,

                        }),
                    })
                    .then(response => response.json())
                    .then(data => {
                            if (data.error) {
                                Swal.showValidationMessage(`Error: ${data.error}`);
                            } else {
                                Swal.fire({
                                    icon: 'success',
                                    title: data.message,
                                }).then(() => {
                                        location.reload();
                                });
                            }
                        });
                }
            });
        }

        function getCookie(name) {
            const cookieValue = document.cookie
                .split('; ')
                .find(row => row.startsWith(name + '='))
                ?.split('=')[1];
            return cookieValue ? decodeURIComponent(cookieValue) : null;
        }
    </script>
    <!-- Script de editar datos-->


</body>


</html>